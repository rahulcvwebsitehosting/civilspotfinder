<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Greenify Event Maestro</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/feather-icons"></script>
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@3.18.0/dist/tf.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow-models/coco-ssd@2.2.2"></script>
    <script src="https://cdn.jsdelivr.net/npm/feather-icons/dist/feather.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/vanta@latest/dist/vanta.waves.min.js"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: {
                            100: '#e0f2f1', 200: '#b2dfdb', 300: '#80cbc4', 400: '#4db6ac',
                            500: '#26a69a', 600: '#009688', 700: '#00897b', 800: '#00796b', 900: '#00695c',
                        },
                        secondary: {
                            100: '#f1f8e9', 200: '#dcedc8', 300: '#c5e1a5', 400: '#aed581',
                            500: '#9ccc65', 600: '#8bc34a', 700: '#7cb342', 800: '#689f38', 900: '#558b2f',
                        }
                    }
                }
            }
        }
    </script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap');
        body { font-family: 'Poppins', sans-serif; }
        .glass-card {
            background: rgba(255, 255, 255, 0.25);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            border: 1px solid rgba(255, 255, 255, 0.18);
        }
        .animate-float { animation: float 6s ease-in-out infinite; }
        @keyframes float { 0%,100% { transform: translateY(0px); } 50% { transform: translateY(-15px); } }
    </style>
</head>
<body class="bg-gradient-to-br from-primary-200 to-primary-400 min-h-screen" id="vanta-bg">
<div class="container mx-auto px-4 py-8">
    <header class="text-center mb-8">
        <div class="inline-block p-4 rounded-full bg-white/20 backdrop-blur-md mb-4 animate-float"><i data-feather="leaf" class="w-12 h-12 text-primary-700"></i></div>
        <h1 class="text-4xl font-bold text-gray-800 mb-2">Greenify Event Maestro</h1>
        <p class="text-lg text-gray-700">Plan sustainable events with eco-conscious precision</p>
    </header>

    <!-- Event Details -->
    <div class="glass-card rounded-2xl shadow-xl p-6 mb-8 max-w-3xl mx-auto">
        <h2 class="text-2xl font-semibold text-gray-800 mb-4 flex items-center"><i data-feather="calendar" class="mr-2"></i> Event Details</h2>
        <div class="space-y-4">
            <div>
                <label class="block text-gray-700 mb-2 font-medium">Event Name</label>
                <input id="ename" type="text" class="w-full px-4 py-3 rounded-lg border border-gray-300 focus:ring-2 focus:ring-primary-500 focus:border-transparent" placeholder="e.g. Eco Conference 2023">
            </div>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <div>
                    <label class="block text-gray-700 mb-2 font-medium">Expected Attendees</label>
                    <input id="att" type="number" min="1" value="100" class="w-full px-4 py-3 rounded-lg border border-gray-300 focus:ring-2 focus:ring-primary-500 focus:border-transparent">
                </div>
                <div>
                    <label class="block text-gray-700 mb-2 font-medium">Meal Type</label>
                    <select id="meal" class="w-full px-4 py-3 rounded-lg border border-gray-300 focus:ring-2 focus:ring-primary-500 focus:border-transparent">
                        <option>Snacks Only</option><option>Breakfast</option><option selected>Lunch</option><option>Dinner</option><option>Full Day</option>
                    </select>
                </div>
            </div>
            <div>
                <label class="block text-gray-700 mb-2 font-medium">Quick Select</label>
                <div class="grid grid-cols-3 sm:grid-cols-6 gap-2">
                    <button class="qs-btn bg-primary-500 hover:bg-primary-600 text-white py-2 px-3 rounded-lg transition-all">50</button>
                    <button class="qs-btn bg-primary-500 hover:bg-primary-600 text-white py-2 px-3 rounded-lg transition-all">100</button>
                    <button class="qs-btn bg-primary-500 hover:bg-primary-600 text-white py-2 px-3 rounded-lg transition-all">200</button>
                    <button class="qs-btn bg-primary-500 hover:bg-primary-600 text-white py-2 px-3 rounded-lg transition-all">500</button>
                    <button class="qs-btn bg-primary-500 hover:bg-primary-600 text-white py-2 px-3 rounded-lg transition-all">1000</button>
                    <button class="qs-btn bg-primary-500 hover:bg-primary-600 text-white py-2 px-3 rounded-lg transition-all">2000+</button>
                </div>
            </div>
            <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
                <label class="inline-flex items-center"><input id="oil" type="checkbox" class="rounded border-gray-300 text-primary-600 shadow-sm focus:border-primary-300 focus:ring focus:ring-primary-200 focus:ring-opacity-50"><span class="ml-2 text-gray-700">Has fried food / oil</span></label>
                <label class="inline-flex items-center"><input id="liq" type="checkbox" class="rounded border-gray-300 text-primary-600 shadow-sm focus:border-primary-300 focus:ring focus:ring-primary-200 focus:ring-opacity-50"><span class="ml-2 text-gray-700">Has liquid refreshment</span></label>
            </div>
        </div>
    </div>

    <!-- AI Crowd Counter -->
    <div class="glass-card rounded-2xl shadow-xl p-6 mb-8 max-w-3xl mx-auto">
        <h2 class="text-2xl font-semibold text-gray-800 mb-4 flex items-center"><i data-feather="camera" class="mr-2"></i> AI Crowd Counter</h2>
        <div class="text-center">
            <div class="relative inline-block mb-4">
                <button class="bg-secondary-500 hover:bg-secondary-600 text-white font-medium py-3 px-6 rounded-lg transition-all flex items-center"><i data-feather="upload" class="mr-2"></i> Upload Crowd Photo</button>
                <input id="crowdFile" type="file" accept="image/*" class="absolute inset-0 w-full h-full opacity-0 cursor-pointer">
            </div>
            <div id="aiCounterPreview" class="border-2 border-dashed border-gray-300 rounded-xl p-4 mb-4"><i data-feather="image" class="w-16 h-16 text-gray-400 mx-auto"></i><p class="text-gray-500 mt-2">Preview will appear here</p></div>
            <div id="aiCounterStatus" class="bg-primary-100 text-primary-800 py-2 px-4 rounded-lg inline-block"><i data-feather="loader" class="animate-spin inline mr-2"></i><span>Ready to analyze</span></div>
        </div>
    </div>

    <!-- Generate Button -->
    <div class="text-center mb-8">
        <button id="generateBtn" class="bg-gradient-to-r from-primary-600 to-secondary-600 hover:from-primary-700 hover:to-secondary-700 text-white font-bold py-4 px-8 rounded-full shadow-lg transform hover:scale-105 transition-all duration-300 flex items-center mx-auto"><i data-feather="zap" class="mr-2"></i> Generate Zero-Waste Plan</button>
    </div>

    <!-- Waste Verification -->
    <div id="wasteVerification" class="glass-card rounded-2xl shadow-xl p-6 mb-8 max-w-3xl mx-auto">
        <h2 class="text-2xl font-semibold text-gray-800 mb-4 flex items-center"><i data-feather="check-circle" class="mr-2"></i> Waste Verification</h2>
        <div class="text-center">
            <div class="relative inline-block mb-4">
                <button class="bg-green-600 hover:bg-green-700 text-white font-medium py-3 px-6 rounded-lg transition-all flex items-center"><i data-feather="upload" class="mr-2"></i> Upload Waste Photo</button>
                <input id="wasteFile" type="file" accept="image/*" class="absolute inset-0 w-full h-full opacity-0 cursor-pointer">
            </div>
            <div id="wastePreview" class="border-2 border-dashed border-gray-300 rounded-xl p-4 mb-4"><i data-feather="image" class="w-16 h-16 text-gray-400 mx-auto"></i><p class="text-gray-500 mt-2">Upload photo of waste collected</p></div>
            <div id="wasteStatus" class="bg-primary-100 text-primary-800 py-2 px-4 rounded-lg inline-block"><i data-feather="loader" class="animate-spin inline mr-2"></i><span>Ready to analyze</span></div>
            <div id="wasteAnalysis" class="hidden">
                <div class="bg-white/70 rounded-xl p-6 mb-4"><h3 class="font-medium text-gray-800 mb-2">Waste Composition Analysis</h3><div class="h-4 bg-gray-200 rounded-full mb-2"><div class="h-full bg-green-500 rounded-full" style="width: 75%"></div></div><div class="flex justify-between text-sm text-gray-600"><span>75% Biodegradable</span><span>25% Plastic/Non-recyclable</span></div></div>
                <div class="bg-primary-100 rounded-xl p-4"><h3 class="font-medium text-primary-800 mb-1">Your Green Score</h3><div class="text-3xl font-bold text-primary-600">85/100</div><p class="text-sm text-primary-700 mt-1">Excellent sustainability effort!</p></div>
            </div>
        </div>
    </div>

    <!-- Results -->
    <div id="results" class="glass-card rounded-2xl shadow-xl p-6 mb-8 max-w-3xl mx-auto hidden">
        <h2 class="text-2xl font-semibold text-gray-800 mb-4 flex items-center"><i data-feather="check-circle" class="mr-2 text-green-500"></i> Your Zero-Waste Plan</h2>
        <div class="bg-white/70 rounded-xl p-6 space-y-6">
            <div class="flex items-start"><div class="bg-primary-100 p-2 rounded-full mr-3"><i data-feather="clipboard" class="text-primary-600"></i></div><div><h3 class="font-medium text-gray-800">Event Overview</h3><p id="resOverview" class="text-gray-600">Loading event details...</p></div></div>
            <div class="flex items-start"><div class="bg-secondary-100 p-2 rounded-full mr-3"><i data-feather="shopping-bag" class="text-secondary-600"></i></div><div><h3 class="font-medium text-gray-800">Required Supplies</h3><ul id="resSupplies" class="list-disc list-inside text-gray-600 space-y-1"></ul></div></div>
            <div class="flex items-start"><div class="bg-primary-100 p-2 rounded-full mr-3"><i data-feather="dollar-sign" class="text-primary-600"></i></div><div><h3 class="font-medium text-gray-800">Estimated Costs</h3><p id="resTotal" class="text-gray-600">Total: ₹0</p><div class="mt-2 bg-blue-50 p-3 rounded-lg"><h4 class="font-medium text-blue-800 mb-1">Cost Breakdown</h4><ul id="resBreak" class="text-sm space-y-1"></ul></div></div></div>
            <div class="flex items-start"><div class="bg-secondary-100 p-2 rounded-full mr-3"><i data-feather="lightbulb" class="text-secondary-600"></i></div><div><h3 class="font-medium text-gray-800">AI-Generated Eco Recommendations</h3><div class="mb-4"><h4 class="text-sm font-medium text-gray-700 mb-1">Nearby Waste Vendors</h4><div class="grid grid-cols-1 sm:grid-cols-2 gap-2 mb-2"><div class="bg-white p-2 rounded-lg border border-gray-200"><div class="flex justify-between"><span class="font-medium">Green Compost Co.</span><span class="text-xs bg-green-100 text-green-800 px-2 py-1 rounded">4.8 ★</span></div><p class="text-xs text-gray-600">1.2km away • ₹500 pickup</p></div><div class="bg-white p-2 rounded-lg border border-gray-200"><div class="flex justify-between"><span class="font-medium">Eco Recycle Hub</span><span class="text-xs bg-green-100 text-green-800 px-2 py-1 rounded">4.5 ★</span></div><p class="text-xs text-gray-600">2.5km away • ₹300 pickup</p></div></div></div><div><h4 class="text-sm font-medium text-gray-700 mb-1">Smart Suggestions</h4><ul class="list-disc list-inside text-gray-600 space-y-1"><li>Use banana leaves for authentic eco-friendly serving</li><li>Set up clearly labeled waste stations (compost, recycling, landfill)</li><li>Partner with local composting facility for waste processing</li><li>Encourage attendees to bring reusable water bottles</li><li>Use digital tickets to reduce paper waste</li><li>Provide bike parking to encourage sustainable transport</li></ul></div></div></div>
            <div class="flex items-start"><div class="bg-primary-100 p-2 rounded-full mr-3"><i data-feather="bar-chart-2" class="text-primary-600"></i></div><div><h3 class="font-medium text-gray-800">Estimated Environmental Impact</h3><div class="grid grid-cols-2 gap-4 mt-2"><div class="bg-green-50 p-3 rounded-lg"><h4 class="font-medium text-green-800">Waste Diverted</h4><p class="text-2xl font-bold text-green-600">~85%</p><p class="text-xs text-green-700">From landfill</p></div><div class="bg-blue-50 p-3 rounded-lg"><h4 class="font-medium text-blue-800">CO₂ Saved</h4><p class="text-2xl font-bold text-blue-600">~200kg</p><p class="text-xs text-blue-700">Compared to conventional</p></div></div></div></div>
        </div>
    </div>

    <!-- Floating buttons -->
    <div class="fixed bottom-4 left-0 right-0 flex justify-center space-x-4 z-10">
        <a href="transport.html" class="bg-secondary-600 hover:bg-secondary-700 text-white px-6 py-3 rounded-lg shadow-lg transition-all flex items-center"><i data-feather="bus"></i><span class="ml-2">Transport</span></a>
        <a href="caption-ai.html" class="bg-primary-600 hover:bg-primary-700 text-white px-6 py-3 rounded-lg shadow-lg transition-all flex items-center"><i data-feather="message-square"></i><span class="ml-2">Caption AI</span></a>
        <a href="voice-generator.html" class="bg-green-600 hover:bg-green-700 text-white px-6 py-3 rounded-lg shadow-lg transition-all flex items-center"><i data-feather="mic"></i><span class="ml-2">Voice Plan</span></a>
        <a href="waste-analysis.html" class="bg-purple-600 hover:bg-purple-700 text-white px-6 py-3 rounded-lg shadow-lg transition-all flex items-center"><i data-feather="activity"></i><span class="ml-2">Waste AI</span></a>
    </div>
</div>

<!-- ===== SCRIPTS ===== -->
<script>feather.replace();</script>
<script>
VANTA.WAVES({el: "#vanta-bg", color: 0x4db6ac, waveHeight: 20, shininess: 50, waveSpeed: 0.5, zoom: 0.8});
/* === Quick-select buttons === */
document.addEventListener('click', e => {
  const btn = e.target.closest('.qs-btn');
  if (!btn) return;
  const val = btn.textContent.replace('+', '');
  document.getElementById('att').value = val;
});
/* === AI Crowd Counter (TensorFlow) === */
let model;
async function loadModel() {
  try {
    model = await cocoSsd.load();
    document.getElementById('crowdFile').addEventListener('change', async e => {
      const file = e.target.files[0]; if (!file) return;
      const preview = document.getElementById('aiCounterPreview');
      const status  = document.getElementById('aiCounterStatus');
      const reader  = new FileReader();
      reader.onload = async ev => {
        const img = new Image(); img.src = ev.target.result;
        preview.innerHTML = `<img src="${ev.target.result}" class="w-full h-auto rounded-lg">`;
        status.innerHTML = '<i data-feather="loader" class="animate-spin inline mr-2"></i> Analysing...'; feather.replace();
        try {
          const preds = await model.detect(img);
          const people = preds.filter(p => p.class === 'person').length;
          document.getElementById('att').value = people;
          status.innerHTML = `<i data-feather="check-circle" class="inline mr-2"></i> Detected ${people} people`;
        } catch (err) {
          status.innerHTML = '<i data-feather="alert-circle" class="inline mr-2"></i> Detection failed';
        }
        feather.replace();
      };
      reader.readAsDataURL(file);
    });
  } catch (err) {
    console.error(err);
    document.getElementById('aiCounterStatus').innerHTML = '<i data-feather="alert-triangle" class="inline mr-2"></i> Model failed';
    feather.replace();
  }
}
loadModel();
/* === Waste-photo analyser (mock) === */
document.getElementById('wasteFile').addEventListener('change', e => {
  const file = e.target.files[0]; if (!file) return;
  const preview = document.getElementById('wastePreview');
  const status  = document.getElementById('wasteStatus');
  const analysis= document.getElementById('wasteAnalysis');
  const reader  = new FileReader();
  reader.onload = ev => {
    preview.innerHTML = `<img src="${ev.target.result}" class="w-full h-auto rounded-lg">`;
    status.innerHTML = '<i data-feather="loader" class="animate-spin inline mr-2"></i> Analysing...'; feather.replace();
    setTimeout(() => {
      const bio = Math.floor(Math.random() * 30) + 70; // 70-100 %
      const score = Math.min(100, bio + 10);
      analysis.classList.remove('hidden');
      analysis.querySelector('.bg-green-500').style.width = bio + '%';
      analysis.querySelector('span:first-child').textContent = bio + '% Biodegradable';
      analysis.querySelector('span:last-child').textContent  = (100 - bio) + '% Plastic/Non-recyclable';
      analysis.querySelector('.text-3xl').textContent = score + '/100';
      analysis.querySelector('.text-sm').textContent =
        score >= 90 ? 'Outstanding!' : score >= 75 ? 'Excellent sustainability effort!' : 'Good job, room for improvement';
      status.innerHTML = '<i data-feather="check-circle" class="inline mr-2"></i> Analysis complete';
      feather.replace();
    }, 1500);
  };
  reader.readAsDataURL(file);
});
/* === Zero-waste maths & generate plan === */
const PRICE = {plate: 3, cup: 2, napkin: 0.5, bin: 650};
function calcWaste() {
  const n = Math.max(1, parseInt(document.getElementById('att').value) || 0);
  const hasOil = document.getElementById('oil').checked;
  const hasLiq = document.getElementById('liq').checked;
  const plates = Math.ceil(n * 1.1);
  const cups   = hasLiq ? Math.ceil(n * 1.15) : 0;
  const napkins= Math.ceil(n * 1.2);
  const oilBags= hasOil ? Math.ceil(n / 50) : 0;
  const compost= Math.ceil(n / 75);
  const recycle= Math.ceil(n / 100);
  const costPlates = (plates * PRICE.plate).toFixed(2);
  const costCups   = (cups   * PRICE.cup ).toFixed(2);
  const costNapkin = (napkins* PRICE.napkin).toFixed(2);
  const costBins   = (compost* PRICE.bin).toFixed(2);
  const total = (parseFloat(costPlates)+parseFloat(costCups)+parseFloat(costNapkin)+parseFloat(costBins)).toFixed(2);
  return {n, plates, cups, napkins, oilBags, compost, recycle, costPlates, costCups, costNapkin, costBins, total, hasOil, hasLiq};
}
document.getElementById('generateBtn').addEventListener('click', () => {
  const w = calcWaste();
  const ename = document.getElementById('ename').value || 'Unnamed Event';
  const meal = document.getElementById('meal').value;
  document.getElementById('resOverview').textContent = `${ename} for ${w.n} attendees (${meal})`;
  document.getElementById('resSupplies').innerHTML = `
    <li>Compostable plates: ${w.plates} (10 % buffer)</li>
    ${w.cups?`<li>Compostable cups: ${w.cups} (15 % buffer)</li>`:''}
    <li>Napkins: ${w.napkins} (20 % buffer)</li>
    ${w.oilBags?`<li>Oil collection bags: ${w.oilBags}</li>`:''}
    <li>Compost bins: ${w.compost} (1 per 75)</li>
    <li>Recycling bins: ${w.recycle} (1 per 100)</li>`;
  document.getElementById('resTotal').textContent = `Total: ₹${w.total}`;
  document.getElementById('resBreak').innerHTML = `
    <li class="flex justify-between"><span>Plates:</span><span>₹${w.costPlates}</span></li>
    ${w.cups?`<li class="flex justify-between"><span>Cups:</span><span>₹${w.costCups}</span></li>`:''}
    <li class="flex justify-between"><span>Napkins:</span><span>₹${w.costNapkin}</span></li>
    <li class="flex justify-between"><span>Bins:</span><span>₹${w.costBins}</span></li>
    <li class="flex justify-between font-medium border-t pt-1 mt-1"><span>Total:</span><span>₹${w.total}</span></li>`;
  document.getElementById('results').classList.remove('hidden');
  document.getElementById('results').scrollIntoView({behavior:'smooth'});
});
/* === Carbon footprint === */
function calculateCarbonFootprint(attendees, mealType, hasOil) {
  let emissions = 0;
  switch(mealType) {
    case 'Snacks Only': emissions = 0.2 * attendees; break;
    case 'Breakfast': emissions = 0.5 * attendees; break;
    case 'Lunch': emissions = 1.2 * attendees; break;
    case 'Dinner': emissions = 1.5 * attendees; break;
    case 'Full Day': emissions = 2.5 * attendees; break;
  }
  if (hasOil) emissions += 0.3 * attendees;
  const savings = emissions * 0.7;
  return {conventional: emissions.toFixed(1), saved: savings.toFixed(1), net: (emissions - savings).toFixed(1)};
}
/* === Voice data restore === */
const voiceData = localStorage.getItem('voiceGeneratedEvent');
if (voiceData) {
  const d = JSON.parse(voiceData);
  document.getElementById('ename').value = d.eventName;
  document.getElementById('att').value = d.attendees;
  document.getElementById('meal').value = d.mealType;
  document.getElementById('oil').checked = d.hasOil;
  document.getElementById('liq').checked = d.hasLiquid;
  localStorage.removeItem('voiceGeneratedEvent');
}
</script>
</body>
</html>
